<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>üôÇ Musterl√∂sung zur Benotete Hausaufgabe zur Java Enterprise Edition</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <div class="container">
            <h1>Musterl√∂sung zur benoteten Hausaufgabe</h1>
            <h2>Java Enterprise Edition</h2>
        </div>

        <div class="container">
            <!-- Allgemeine Fragen -->
            <h3>1. Allgemeine Fragen</h3>

            <p>
                a) Selbstgeschriebene Klassen und JSPs zur Auflistung der vorhandenen Aufgaben (1P):
            </p>
            <table>
                <thead>
                    <tr>
                        <th>
                            Klasse / JSP
                        </th>
                        <th>
                            Aufgabe
                        </th>
                    </tr>
                </thead>
                <tr>
                    <td>
                        <tt>TaskListServlet</tt>
                    </td>
                    <td>
                        Servlet, das die Suche und Anzeige steuert
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>CategoryBean</tt>
                    </td>
                    <td>
                        EJB zur Verwaltung der Kategorien
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>TaskBean</tt>
                    </td>
                    <td>
                        EJB zur Verwaltung der Aufgaben
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>Category</tt>
                    </td>
                    <td>
                        Persistence Entity f√ºr Kategorien
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>Task</tt>
                    </td>
                    <td>
                        Persistence Entity f√ºr Aufgaben
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>TaskStatus</tt>
                    </td>
                    <td>
                        Aufz√§hlung der Aufgabenstati (Offen, In arbeit, ‚Ä¶)
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>task_list.jsp</tt>
                    </td>
                    <td>
                        JSP-Datei zur Anzeige der Liste
                    </td>
                </tr>
            </table>

            <p>
                b) √Ñnderungen an der Methode <tt>‚Ä¶.ejb.TaskBean.search()</tt>, um den Eigent√ºmer als weiteres
                Suchkriterium einzuf√ºgen (2P):
            </p>
            <ol class="spacing">
                <li>
                    Es m√ºsste ein weiterer Parameter <tt>User owner</tt> hinzugef√ºgt werden.
                </li>
                <li>
                    Kurz vor dem Ende m√ºsste folgender Quellcode eingebaut werden:

<pre><code>if (owner != null) {
    query.where(cb.equal(from.get("owner"), owner));
}</code></pre>
                </li>
            </ol>

            <p>
                c) Schritte in <tt>‚Ä¶.web.TaskEditServlet</tt> beim Speichern eines Datensatzes (2P):
            </p>
            <ol class="spacing">
                <li>
                    Zun√§chst wird in <tt>doPost()</tt> gerpf√ºt, ob im Parameter <tt>action</tt> der Wert <tt>save</tt>
                    oder <tt>delete</tt> mitgegeben wurde. Je nach Wert wird dann die Methode <tt>saveTask()</tt> oder
                    <tt>deleteTask</tt> aufgerufen.
                </li>
                <li>
                    In <tt>saveTask()</tt> werden dann zun√§chst alle Formularfelder ausgelesen und in Stringfelder geschrieben.
                </li>
                <li>
                    Danach wird <tt>getRequestedTask()</tt> aufgerufen, um anhand der URL entweder das zu bearbeitende
                    <tt>Task</tt>-Objekt auszulesen oder eine neue Objektinstanz zu erzeugen.
                </li>
                <li>
                    Anschlie√üend werden die eingegebenen Werte an das ermittelte <tt>Task</tt>-Objekt √ºbergeben.
                    Kommt es dabei zu Fehlern, wie zum Beispiel dass das Datum oder die Uhrzeit nicht interpretiert
                    werden k√∂nnen, werden diese in die Fehlerliste aufgenommen.
                </li>
                <li>
                    Das <tt>Task</tt>-Objekt wird mit der <tt>ValidationBean</tt> √ºberpr√ºft.
                </li>
                <li>
                    Falls keine Fehler gefunden wurden, wird der Datensatz gespeichert und der Anwender zur
                    Startseite weitergeleitet.
                </li>
                <li>
                    Falls es Fehler gab, werden die bisherigen Formulareingaben und gefundenen Fehler in der HTTP-Session
                    abgelegt und das Erfassungsformular erneut angezeigt.
                </li>
            </ol>

            <!-- Benutzerauthentifizierung -->
            <h3>2. Benutzerauthentifizierung</h3>

            <p>
                a) Konfiguration in der Datei <tt>Web Pages\WEB-INF\web.xml</tt> (2P):
            </p>
            <ul class="spacing">
                <li>
                    <tt>&lt;security-constraint&gt;</tt>: Hier wird definiert, dass alle URLs, die mit <tt>/app/*</tt>
                    beginnen nur von Benutzern aufgerufen werden k√∂nnen, die die Rolle <tt>todo-app-user</tt> besitzen.
                    Der Aufruf muss zus√§tzlich √ºber eine gesicherte HTTPS-Verbindung erfolgen.
                </li>
                <li>
                    <tt>&lt;security-role&gt;</tt>: Hier wird die Rolle <tt>todo-app-user</tt> definiert.
                </li>
                <li>
                    <tt>&lt;login-config&gt;</tt>: Hier wird festgelegt, dass die Authentifizierung √ºber ein Login-Formular
                    erfolgt und es werden die JSP-Dateien f√ºr das Formular und die Fehlerseite hinterlegt.
                </li>
            </ul>

            <p>
                b) Die Tabelle mit den Benutzerdaten wird in der Serverkonfiguration hinterlegt. Es handelt sich dabei
                um die Schritte, die am Anfang des Aufgabenblatts manuell auszuf√ºhren sind. (1P)
            </p>

            <p>
                c) Zus√§tzlicher Code zur Definition einer weiteren Benutzerrolle (1P):
            </p>
<pre><code>&lt;security-role&gt;
    &lt;description&gt;
        Beschreibung ‚Ä¶
    &lt;/description&gt;
    &lt;role-name&gt;name-der-rolle&lt;/role-name&gt;
&lt;/security-role&gt;</code></pre>
            <p>
                d) Zur Pr√ºfung der neuen Rolle kann die Annotation <tt>@RolesAllowed("name-der-rolle")</tt> verwendet werden. (1P)
            </p>

            <!-- Bean Validation -->
            <h3>3. Bean Validation</h3>

            <p>
                a) Verwendete Annotationen zur Beanvalidierung (1P):
            </p>
            <table>
                <thead>
                    <tr>
                        <th>
                            Annotation
                        </th>
                        <th>
                            Aufgabe
                        </th>
                    </tr>
                </thead>
                <tr>
                    <td>
                        <tt>@NotNull</tt>
                    </td>
                    <td>
                        Stellt sicher, dass der Wert niemals <tt>null</tt> sein darf.
                    </td>
                </tr>
                <tr>
                    <td>
                        <tt>@Size</tt>
                    </td>
                    <td>
                        Legt die Mindest- und Maximall√§nge eines Wertes fest.
                    </td>
                </tr>
            </table>

            <p>
                b) Weitere, nicht im Quellcode verwendete Annotationen:
                <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/package-summary.html" target="_blank">Siehe hier</a>
                (2P)
            </p>

            <p>
                c) M√∂gliche Vorteile aus der Nutzung von Bean Validation, auch in Hinblick auf unterschiedliche
                Clients der Anwendung (2P):
            </p>
            <ol class="spacing">
                <li>
                    Es muss weniger Quellcode geschrieben werden, die meisten <tt>if</tt>-Abfragen k√∂nnen durch
                    einfache Annotationen ersetzt werden.
                </li>
                <li>
                    Die Annotationen werden direkt bei den Entity-Klassen hinzugef√ºgt, da es um die Eigenschaften
                    ihrer Felder geht. Es finden kaum noch manuelle Pr√ºfungen in den Servlets statt.
                </li>
                <li>
                    Dadurch m√ºssen die Pr√ºfungen auch nicht f√ºr jeden Client aufs Neue programmiert werden, was
                    beim alten Vorgehen der Fall w√§re, da alle Clients zwar die EJBs oft aber nicht die Servlets
                    der Anwendung nutzen k√∂nnen.
                </li>
            </ol>
        </div>
    </body>
</html>
